# SMaRt (Sales Marketing almost Real time)
Scripts to summarize business meaning from text in documents

The scripts are non desctructive e.g. given a set of base files (.docx, .pdf etc it should be able to reproduce everything from scratch).

Exception to the rule are specific **FILES** listed below e.g. *table_world_knowledge.xlsx* which contains business specific info about key words (e.g. is it a country)

## Folder Structure
- **data** : Source data (e.g. diagnostics and reports)
- **incubator** : samples and features in progress, not fully complete
- **lib** : binary tools and libraries not installed via pip or conda e.g. docto.exe
- **output** :  Outputs from the various scripts
- **scripts** : Commands and tests  (documented below)
- **web**:  web application to display the analysis generated by the scripts *in progress*
- **.(main folder)** : everything else - including output

## SCRIPTS
All scripts will give an example of their usage when called without parameters

+ **smart_extract_text.py**
	- Convert documents (pdf, ppt, doc, docx, xls etc) in folder to text. 
	- Sample usage: python .\smart_text.py name_of_folder_with_docs
	- Output - text file version of document, in the same folder as the origial document

+ **smart_generate_meta_data.py** 
	- Extract meta data from a collection of text files (e.g. Dictionary for Gensim, New words not already in knowledgebase).
	- Sample usage: python smart_generate_meta_data.py .\table_word_knowledge.xlsx smr output
	- Outputs dictonary of new keywords not in the word knowledebase (which then needs to be copy-pasted into knowledgebase as required)
	- Outputs a cached gensim corpus object
	- Outputs a cahced gensim dictionary object
	- Depends on output from *smart_extract_text.py*
	- Depends on word_knowledge.xlsx for existing knowledge

+ **smart_analyse_file_keyword.py** 
	- Extraction of keyword meta from text docs - e.g. number of times a keywords appears
	- Sample usage:  python .\quick_smart.py .\table_word_knowledge.xlsx smr output.csv
	- Output is csv file with filename, keyword, number of times in doc
	- Sample usage:  python .\quick_smart.py .\table_word_knowledge.xlsx smr output.csv
	- Depends on text files from *smart_extract_text.py*, 
	- Used by: SMaRt.xlsx as basis for it's real time info


+ **smart_analyse_gensim_topics.py** 
	- Perform LDA and LSA topic analysis using Gensim
	- Sample usage:  python .\quick_smart.py .\table_word_knowledge.xlsx smr output.csv
	- Output: *TODO* 
	- Depends on text files from *smart_extract_text.py*, 


+ **smart_analyse_cosine_similarity**
	- Perform Cosine similarity using Gensim 
	- More info:  https://www.machinelearningplus.com/nlp/cosine-similarity/
	- Sample usage:  python scripts\smart_analyse_cosine_similarity.py name_of_directory_with_docs_to_analyze
	- Output *smart_Cosine_Similarity_Output.xlsx* - Excel file containing a matrix of ho
	- Depends on text files from *smart_extract_text.py*



## KEY FILES

### Key files - do not delete
- *table word_knowledge.xlsx*
	- What we know about specific keywords that are significant in sales and marketing
	- Format
		- keyword
		- stoplist (should we strip out) e.g. common words like if, then en etc
		- mapping
		- country (is this a country - y/n)
		- highlight - should we show on filtering?
		- hex - which hex would this score into?
- *Smart_Report.xlsx*
	- Excel template to displays the output of keyword / file analysis
	- format filename,keyword,keyword (repeated makes for easier pivot table), count

### Interim Text files - can be recreated as script
+ *smart_text.py*,  extracts the text from files of another format (e.g. doc, pdf, ppt etc)
+ All scripts operate on these text file as input.

### Other Interim Files Created by one script (for use by another)
- *output2.dict* - dictionary of words from input text files
- *output.corpus* - corpus document
- *output.new_words.csv* - new words that we haven't see before (i.e. not in table_word_knowledge.xlsx)


